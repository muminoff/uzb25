{% extends "base.html" %}
{% load staticfiles %}
{% block content %}
<div class="container">
    <h3><img src="https://maxcdn.icons8.com/Color/PNG/48/Social_Networks/twitter-48.png" title="Twitter" width="48">Онлайн твитлар</h3>
    <table class="table table-condensed table-hover" id="online_tweets">
        <thead>
            <tr>
                <th>Муаллиф</th>
                <th>Пост</th>
                <th>Манзил</th>
                <th>Вақти</th>
                <th>Ҳавола</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
{% endblock %}
{% block javascript %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script>
var socket = io.connect('http://uzb25bot.herokuapp.com');
socket.on('tweet', function (data) {
  var tweet_content = "<tr><td><img src='" + data.avatar +"'/> " + data.username + " (" + data.screenname + ")</td>";
  tweet_content += "<td>" + data.text + "</td>";
  tweet_content += "<td>" + data.location + "</td>";
  tweet_content += "<td>" + data.created_at + "</td>";
  tweet_content += "<td><a href='https://twitter.com/'>" + data.id + "</a></td>";
  tweet_content += "</tr>";
  $("#online_tweets").prepend(tweet_content);
});
</script>
{% endblock %}
